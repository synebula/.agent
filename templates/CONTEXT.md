# CONTEXT.md 模板（信息分层版）

```markdown
# 项目上下文：[项目名称]

> **最后更新**：YYYY-MM-DD | **原则**：索引优先，详情外置，按需查阅

---

## 核心信息

**项目定位**：[1-2句话简述项目是什么]

**技术栈**：
- 后端：[语言 + 框架]
- 前端：[框架]
- 数据库：[类型 + 版本]
- 缓存/消息队列：[如有]

**架构风格**：[单体 / 微服务 / Serverless / 其他]

---

## 模块索引

> 子模块的详细信息见各自的 CONTEXT.md

- **[模块1路径]/**：[1句话说明职责] → 详见 `[模块1路径]/.agent/CONTEXT.md`
- **[模块2路径]/**：[1句话说明职责] → 详见 `[模块2路径]/.agent/CONTEXT.md`

**目录结构**（关键路径）：
```
project-root/
├── .agent/          # 项目记忆
├── [模块1]/         # [职责]
├── [模块2]/         # [职责]
└── docs/            # 文档
```

---

## 全局约定

### 代码风格
- **[语言1]**：[工具/规范]
- **[语言2]**：[工具/规范]

### 命名规范
- 变量/函数：[camelCase / snake_case]
- 数据库表：[snake_case / kebab-case]
- 文件名：[规则]

### 关键依赖管理
- **[语言]**：[包管理工具 + 策略]

**详细规范**：见 `docs/coding-standards.md`

---

## 架构核心

### 关键模块（项目级）

**[模块A]** (`路径`)
- **职责**：[1句话]
- **核心接口/类**：[2-3个关键API]

**[模块B]** (`路径`)
- **职责**：[1句话]
- **核心接口/类**：[2-3个关键API]

### 跨模块约定

- **错误处理**：[统一格式/策略]
- **日志规范**：[工具 + 格式]
- **配置管理**：[方式]

**详细架构**：见 `docs/architecture.md`

---

## 关键决策历史（近期）

> 仅保留近期 3-5 条架构级重要决策，完整历史见 `.agent/CHANGELOG.md`

### YYYY-MM-DD - [决策标题]
- **变更**：[简述]
- **影响**：[模块/文件]
- **详情**：`.agent/TASK-[任务名].md`

### YYYY-MM-DD - [决策标题]
- **变更**：[简述]
- **影响**：[模块/文件]
- **详情**：[文档链接]

[查看完整历史：`.agent/CHANGELOG.md`]

---

## 外部文档索引

- **架构设计**：`docs/architecture.md`
- **开发规范**：`docs/coding-standards.md`
- **API文档**：`docs/api/` 或在线文档链接
- **部署运维**：`docs/deployment.md`
- **变更历史**：`.agent/CHANGELOG.md`
```

---

## 使用说明

### 原则

1. **索引优先**：CONTEXT.md 是导航，不是百科全书
2. **详情外置**：超过 3 行的说明应放到 docs/ 或子模块 CONTEXT.md
3. **按需更新**：架构调整、全局约定变更时更新；日常 bugfix 无需修改

### 字段说明

**必填**：
- 核心信息：技术栈、架构风格
- 模块索引：子模块路径 + 职责
- 全局约定：代码风格、命名规范

**可选**：
- 架构核心：如果项目简单可省略
- 关键决策历史：新项目可为空

### Token 控制目标

- 项目根 CONTEXT.md：≤ 800 tokens
- 模块级 CONTEXT.md：≤ 400 tokens
- 子目录 CONTEXT.md：≤ 200 tokens
